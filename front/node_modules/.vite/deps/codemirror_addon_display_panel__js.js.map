{
  "version": 3,
  "sources": ["../../codemirror/addon/display/panel.js"],
  "sourcesContent": ["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/5/LICENSE\n\n(function (mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function (CodeMirror) {\n  CodeMirror.defineExtension(\"addPanel\", function (node, options) {\n    options = options || {};\n\n    if (!this.state.panels) initPanels(this);\n\n    var info = this.state.panels;\n    var wrapper = info.wrapper;\n    var cmWrapper = this.getWrapperElement();\n    var replace = options.replace instanceof Panel && !options.replace.cleared;\n\n    if (options.after instanceof Panel && !options.after.cleared) {\n      wrapper.insertBefore(node, options.before.node.nextSibling);\n    } else if (options.before instanceof Panel && !options.before.cleared) {\n      wrapper.insertBefore(node, options.before.node);\n    } else if (replace) {\n      wrapper.insertBefore(node, options.replace.node);\n      options.replace.clear(true);\n    } else if (options.position == \"bottom\") {\n      wrapper.appendChild(node);\n    } else if (options.position == \"before-bottom\") {\n      wrapper.insertBefore(node, cmWrapper.nextSibling);\n    } else if (options.position == \"after-top\") {\n      wrapper.insertBefore(node, cmWrapper);\n    } else {\n      wrapper.insertBefore(node, wrapper.firstChild);\n    }\n\n    var height = (options && options.height) || node.offsetHeight;\n\n    var panel = new Panel(this, node, options, height);\n    info.panels.push(panel);\n\n    this.setSize();\n    if (options.stable && isAtTop(this, node))\n      this.scrollTo(null, this.getScrollInfo().top + height);\n\n    return panel;\n  });\n\n  function Panel(cm, node, options, height) {\n    this.cm = cm;\n    this.node = node;\n    this.options = options;\n    this.height = height;\n    this.cleared = false;\n  }\n\n  /* when skipRemove is true, clear() was called from addPanel().\n   * Thus removePanels() should not be called (issue 5518) */\n  Panel.prototype.clear = function (skipRemove) {\n    if (this.cleared) return;\n    this.cleared = true;\n    var info = this.cm.state.panels;\n    info.panels.splice(info.panels.indexOf(this), 1);\n    this.cm.setSize();\n    if (this.options.stable && isAtTop(this.cm, this.node))\n      this.cm.scrollTo(null, this.cm.getScrollInfo().top - this.height)\n    info.wrapper.removeChild(this.node);\n    if (info.panels.length == 0 && !skipRemove) removePanels(this.cm);\n  };\n\n  Panel.prototype.changed = function () {\n    this.height = this.node.getBoundingClientRect().height;\n    this.cm.setSize();\n  };\n\n  function initPanels(cm) {\n    var wrap = cm.getWrapperElement()\n    var style = window.getComputedStyle ? window.getComputedStyle(wrap) : wrap.currentStyle;\n    var height = parseInt(style.height);\n    var info = cm.state.panels = {\n      setHeight: wrap.style.height,\n      panels: [],\n      wrapper: document.createElement(\"div\")\n    };\n    var hasFocus = cm.hasFocus(), scrollPos = cm.getScrollInfo()\n    wrap.parentNode.insertBefore(info.wrapper, wrap);\n    info.wrapper.appendChild(wrap);\n    cm.scrollTo(scrollPos.left, scrollPos.top)\n    if (hasFocus) cm.focus();\n\n    cm._setSize = cm.setSize;\n    if (height != null) cm.setSize = function (width, newHeight) {\n      if (!newHeight) newHeight = info.wrapper.offsetHeight;\n      info.setHeight = newHeight;\n      if (typeof newHeight != \"number\") {\n        var px = /^(\\d+\\.?\\d*)px$/.exec(newHeight);\n        if (px) {\n          newHeight = Number(px[1]);\n        } else {\n          info.wrapper.style.height = newHeight;\n          newHeight = info.wrapper.offsetHeight;\n        }\n      }\n      var editorheight = newHeight - info.panels\n        .map(function (p) { return p.node.getBoundingClientRect().height; })\n        .reduce(function (a, b) { return a + b; }, 0);\n      cm._setSize(width, editorheight);\n      height = newHeight;\n    };\n  }\n\n  function removePanels(cm) {\n    var info = cm.state.panels;\n    cm.state.panels = null;\n\n    var wrap = cm.getWrapperElement()\n    var hasFocus = cm.hasFocus(), scrollPos = cm.getScrollInfo()\n    info.wrapper.parentNode.replaceChild(wrap, info.wrapper);\n    cm.scrollTo(scrollPos.left, scrollPos.top)\n    if (hasFocus) cm.focus();\n    wrap.style.height = info.setHeight;\n    cm.setSize = cm._setSize;\n    cm.setSize();\n  }\n\n  function isAtTop(cm, dom) {\n    for (var sibling = dom.nextSibling; sibling; sibling = sibling.nextSibling)\n      if (sibling == cm.getWrapperElement()) return true\n    return false\n  }\n});\n"],
  "mappings": "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",
  "names": ["CodeMirror"]
}
